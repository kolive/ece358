package lab2.simulate;

/**
 * Simple ds to represent the buffer
 * This linked list should always have size elements, but all of them could be "null" packets
 * @author Kyle
 *
 */
public class Buffer {
	
	class Packet{
		
		public int sn;
		public int size;
		public double time;
		
		Packet(int sn, int size, double time){
			this.sn = sn;
			this.size = size;
			this.time = time;
		}
		
		Packet(){
			sn = -1;
			size = -1;
			time = -1;
		}
		
	}

	Packet[] buffer;
	int head;
	int nextSN;
	int nextNull;
	
	public Buffer(int size){
		
		if(size > 0){
			buffer = new Packet[size];
		}
		
		for(int i = 0; i < size; i++){
			buffer[i] = new Packet();
		}
		
		nextNull = 0;
		head = 0;
	}
	
	void setNextNull(){
		if(nextNull == -1) nextNull = 0;
		for(int i = nextNull, n = 0; n < buffer.length; i = (i + 1)%buffer.length){
			if(buffer[i].sn == -1){
				nextNull = i;
				return;
			}
		}
		nextNull = -1;
	}
	
	public Packet getFront(){
		return buffer[head];
	}
	
	public Packet getN(int n){
		return buffer[(head + n)%n];
	}
	
	public void addPacket(int sn, int size, double time){
		buffer[nextNull] = new Packet(sn, size, time);
		nextSN = sn;
		setNextNull();
	}
	
	public void shift(){
		buffer[head] = new Packet();
		head = (head + 1)%buffer.length;
		setNextNull();
	}
	

}
